---
phase: 01-foundation-events
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - tsconfig.json
  - next.config.ts
  - tailwind.config.ts
  - app/layout.tsx
  - app/globals.css
  - app/page.tsx
  - db/index.ts
  - db/schema.ts
  - drizzle.config.ts
  - lib/validations/events.ts
  - components/ui/*
autonomous: true

must_haves:
  truths:
    - "npm run dev starts development server without errors"
    - "Database file sporttag.db is created when server starts"
    - "Events table exists in database with correct schema"
    - "shadcn/ui components are available for import"
  artifacts:
    - path: "package.json"
      provides: "Project dependencies"
      contains: "drizzle-orm"
    - path: "db/schema.ts"
      provides: "Database schema definition"
      exports: ["events"]
    - path: "db/index.ts"
      provides: "Database connection singleton"
      exports: ["db"]
    - path: "lib/validations/events.ts"
      provides: "Zod validation schema"
      exports: ["eventSchema", "EventInput"]
    - path: "components/ui/button.tsx"
      provides: "shadcn Button component"
  key_links:
    - from: "db/index.ts"
      to: "db/schema.ts"
      via: "import * as schema"
      pattern: "import.*schema.*from.*schema"
    - from: "drizzle.config.ts"
      to: "db/schema.ts"
      via: "schema path reference"
      pattern: "schema:.*db/schema"
---

<objective>
Set up the Next.js 16 project foundation with SQLite database, Drizzle ORM, shadcn/ui components, and the events schema.

Purpose: Establish the technical foundation that all Phase 1 event management features will build upon. This plan creates the project structure, database layer, and UI component library.

Output: A running Next.js 16 development server with SQLite database, Drizzle ORM configured, shadcn/ui components installed, and events table schema ready for CRUD operations.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation-events/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Next.js 16 project with dependencies</name>
  <files>
    package.json
    tsconfig.json
    next.config.ts
    tailwind.config.ts
    app/layout.tsx
    app/globals.css
    app/page.tsx
  </files>
  <action>
Create the Next.js 16 project and install all dependencies:

1. Run `npx create-next-app@latest . --yes` in the project root (current directory has only .planning and README.md, so create-next-app will scaffold here)

2. Install database dependencies:
   ```bash
   npm install drizzle-orm better-sqlite3
   npm install -D drizzle-kit @types/better-sqlite3
   ```

3. Install validation:
   ```bash
   npm install zod
   ```

4. Initialize shadcn/ui:
   ```bash
   npx shadcn@latest init --defaults
   ```
   Use defaults: style=default, base color=slate, CSS variables=yes

5. Add required shadcn components:
   ```bash
   npx shadcn@latest add button card form input label table textarea
   ```

6. Update app/page.tsx to be a simple landing page:
   ```tsx
   import Link from 'next/link'
   import { Button } from '@/components/ui/button'

   export default function Home() {
     return (
       <main className="container mx-auto py-8">
         <h1 className="text-3xl font-bold mb-4">Sporttag-Anmeldeplattform</h1>
         <p className="text-muted-foreground mb-6">
           Verwaltung von Sportveranstaltungen und Schueleranmeldungen
         </p>
         <Button asChild>
           <Link href="/events">Veranstaltungen verwalten</Link>
         </Button>
       </main>
     )
   }
   ```

7. Update app/layout.tsx to include German language attribute:
   ```tsx
   export default function RootLayout({ children }) {
     return (
       <html lang="de">
         ...
       </html>
     )
   }
   ```
  </action>
  <verify>
Run `npm run dev` - server starts without errors on http://localhost:3000.
Visit http://localhost:3000 - page loads with "Sporttag-Anmeldeplattform" heading.
Check that components/ui/ directory contains button.tsx, card.tsx, etc.
  </verify>
  <done>
Next.js 16 dev server runs. Landing page displays. shadcn/ui components are installed in components/ui/.
  </done>
</task>

<task type="auto">
  <name>Task 2: Set up SQLite database with Drizzle ORM</name>
  <files>
    db/index.ts
    db/schema.ts
    drizzle.config.ts
    lib/validations/events.ts
    .gitignore
  </files>
  <action>
Create the database layer following the patterns from RESEARCH.md:

1. Create drizzle.config.ts in project root:
   ```typescript
   import type { Config } from 'drizzle-kit'

   export default {
     schema: './db/schema.ts',
     out: './db/migrations',
     dialect: 'sqlite',
     dbCredentials: {
       url: './sporttag.db',
     },
   } satisfies Config
   ```

2. Create db/schema.ts with events table:
   ```typescript
   import { sqliteTable, text, integer } from 'drizzle-orm/sqlite-core'

   export const events = sqliteTable('events', {
     id: integer('id').primaryKey({ autoIncrement: true }),
     name: text('name').notNull(),
     description: text('description'),
     capacity: integer('capacity').notNull(),
     createdAt: integer('created_at', { mode: 'timestamp' })
       .$defaultFn(() => new Date()),
     updatedAt: integer('updated_at', { mode: 'timestamp' })
       .$defaultFn(() => new Date()),
   })

   // Type inference for TypeScript
   export type Event = typeof events.$inferSelect
   export type NewEvent = typeof events.$inferInsert
   ```

3. Create db/index.ts with database connection:
   ```typescript
   import { drizzle } from 'drizzle-orm/better-sqlite3'
   import Database from 'better-sqlite3'
   import * as schema from './schema'

   const sqlite = new Database('sporttag.db')
   sqlite.pragma('foreign_keys = ON')  // Enable foreign key constraints

   export const db = drizzle(sqlite, { schema })
   ```

4. Create lib/validations/events.ts with Zod schema:
   ```typescript
   import { z } from 'zod'

   export const eventSchema = z.object({
     name: z.string()
       .min(1, 'Name ist erforderlich')
       .max(100, 'Name darf maximal 100 Zeichen lang sein'),
     description: z.string()
       .max(1000, 'Beschreibung darf maximal 1000 Zeichen lang sein')
       .optional()
       .or(z.literal('')),
     capacity: z.coerce.number()
       .int('Kapazitaet muss eine ganze Zahl sein')
       .min(1, 'Kapazitaet muss mindestens 1 sein')
       .max(500, 'Kapazitaet darf maximal 500 sein'),
   })

   export type EventInput = z.infer<typeof eventSchema>
   ```

5. Add sporttag.db to .gitignore:
   ```
   # Database
   sporttag.db
   ```

6. Generate and apply the initial migration:
   ```bash
   npx drizzle-kit generate
   npx drizzle-kit migrate
   ```
  </action>
  <verify>
Run `npx drizzle-kit studio` - opens Drizzle Studio showing events table.
Check that sporttag.db file exists in project root.
Check that db/migrations/ directory contains migration files.
Run `npm run dev` - no database errors on startup.
  </verify>
  <done>
SQLite database created. Events table exists with id, name, description, capacity, createdAt, updatedAt columns. Drizzle ORM configured. Zod validation schema exported.
  </done>
</task>

</tasks>

<verification>
After both tasks complete:
1. `npm run dev` starts without errors
2. http://localhost:3000 shows landing page with "Veranstaltungen verwalten" button
3. sporttag.db file exists
4. `npx drizzle-kit studio` shows events table with correct schema
5. components/ui/ contains shadcn components (button, card, form, input, label, table, textarea)
6. lib/validations/events.ts exports eventSchema
</verification>

<success_criteria>
- Next.js 16 project running with TypeScript and Tailwind CSS v4
- SQLite database initialized with events table
- Drizzle ORM configured with type-safe schema
- shadcn/ui components installed and importable
- Zod validation schema for events ready
- Foundation complete for Plan 02 (Event CRUD)
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-events/01-01-SUMMARY.md`
</output>
